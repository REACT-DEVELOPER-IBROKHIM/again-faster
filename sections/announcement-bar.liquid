{%- for block in section.blocks -%}
  {%- case block.type -%}
    {%- when "announcement" -%}
      {% if block.settings.announcement_enabled %}
        <div class="announcement-bar" role="region" aria-label="announcement" {{ block.shopify_attributes }}>
          {%- if block.settings.announcement_text != blank -%}
          {%- if block.settings.link != blank -%}
            <a href="{{ block.settings.link }}" class="announcement-bar-link">
              {{ block.settings.announcement_text }}
            </a>
          {% else %}
              <p class="announcement-bar-link">{{ block.settings.announcement_text }}</p>
          {% endif %} 
          {% endif %}
        </div>
      {% endif %}
  {% endcase %}
{% endfor %}

{% schema %}
{
  "name": "Announcement Bar",
  "max_blocks": 2,
  "blocks": [
    {
      "type": "announcement",
      "name": "Announcement bar",
      "settings": [
        {
          "type": "text",
          "id": "announcement_text",
          "default": "20% OFF Sitewide until 9/12",
          "label": "Announcement Bar text"
        },
        {
          "type" : "checkbox",
          "id" : "announcement_enabled",
          "default" : true,
          "label" : "Show announcement bar"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Announcement Link"
        }
      ]
    }
  ],
  "default": {
    "blocks": [
      {
        "type": "announcement"
      }
    ]
  }
}
{% endschema %}
